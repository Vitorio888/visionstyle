const bodyEl=document.querySelector("body"),burger=document.querySelector(".js-burger"),menu=document.querySelector(".js-menu-nav"),menuLink=document.querySelectorAll(".menu-nav__link"),modal=document.querySelector(".modal");let cart={};function loadCart(){if(localStorage.getItem("cart"))cart=JSON.parse(localStorage.getItem("cart")),showCart();else{let t="";t+='<p class="main-cart__empty">Корзина пуста!\n                    <a href="index.html#catalog" class="main-cart__catalog">Заполнить корзину.</a>    \n                </p>',$(".main-cart").html(t)}}function showCart(){if(isEmpty(cart))$.getJSON("goods.json",(function(t){let a=t,e="";for(let t in cart)e+=`<div class="main-cart__item">\n                            <picture><source srcset="img/${a[t].imgwebp}" type="image/webp"><img class="main-cart__image" src="img/${a[t].img}" alt="${a[t].name}"></picture>\n                            <p class="main-cart__name">${a[t].name}</p>\n                            <div class="main-cart__counter">\n                                <button class="main-cart__minus-goods" type="button" data-id="${t}">-</button>\n                                <p class="main-cart__quantity">${cart[t]}</p>\n                                <button class="main-cart__plus-goods" type="button" data-id="${t}">+</button>\n                            </div>\n                            <p class="main-cart__sum">${cart[t]*a[t].cost} грн</p>\n                            <button class="main-cart__del-goods" type="button" data-id="${t}"></button>\n                        </div>`;$(".main-cart").html(e),$(".main-cart__del-goods").on("click",delGoods),$(".main-cart__plus-goods").on("click",plusGoods),$(".main-cart__minus-goods").on("click",minusGoods),showAllSum()}));else{let t="";t+='<p class="main-cart__empty">Корзина пуста!\n                    <a href="index.html#catalog" class="main-cart__catalog">Заполнить корзину.</a>    \n                </p>',$(".main-cart").html(t),showAllSum(0)}}function showAllSum(){let t=document.querySelectorAll(".main-cart__sum"),a=0;[].forEach.call(t,(function(t){a+=parseInt(t.innerText)})),document.querySelector(".all").innerText=a+" грн"}function delGoods(){let t=$(this).attr("data-id");delete cart[t],saveСart(),showCart()}function plusGoods(){let t=$(this).attr("data-id");cart[t]++,saveСart(),showCart()}function minusGoods(){let t=$(this).attr("data-id");1==cart[t]?delete cart[t]:cart[t]--,saveСart(),showCart()}function saveСart(){localStorage.setItem("cart",JSON.stringify(cart))}function isEmpty(t){for(let a in t)return!!t.hasOwnProperty(a)}function sendEmail(){let t=$(".ename").val(),a=$(".email").val(),e=$(".ephone").val();""!=t&&""!=e&&""==a?isEmpty(cart)?$.post("core/mail.php",{ename:t,ephone:e,cart:cart},(function(t){1==t?(alert("Заказ отправлен"),localStorage.removeItem("cart")):alert("Повторите заказ")})):alert("Корзина пуста!"):""!=t&&""!=a&&""!=e?isEmpty(cart)&&$.post("core/mail.php",{ename:t,email:a,ephone:e,cart:cart},(function(t){1==t?(alert("Заказ отправлен"),localStorage.removeItem("cart")):alert("Повторите заказ")})):alert("Заполните поля")}function showMenu(){bodyEl.classList.toggle("active"),menuLink.forEach(t=>t.addEventListener("click",closeMenu)),modal.addEventListener("click",closeMenu)}function closeMenu(){bodyEl.classList.remove("active")}$(document).ready((function(){loadCart(),$('.form__input[type="tel"]').inputmask({mask:"+38 999 999-99-99"}),$(".send-email").on("click",sendEmail),burger.addEventListener("click",showMenu)}));